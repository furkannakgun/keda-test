trigger:
- master

pool:
  vmImage: 'ubuntu-latest'
  name: tzl-shrd
  demands:
  - agent.name -equals 'tzl-shrd-ado-cf7fdc95-cf9vl'

variables:
  dockerRegistryServiceConnection: 'harbortaas'
  imageName: 'furkan-nginx/furkan-nginx'
  tag: '$(Build.BuildId)'

steps:
- script: docker build -t $(imageName):$(tag) .
  displayName: 'Docker Build'

- script: docker tag $(imageName):$(tag) $(dockerRegistryServiceConnection)/$(imageName):$(tag)
  displayName: 'Docker Tag'

- script: docker push $(dockerRegistryServiceConnection)/$(imageName):$(tag)
  displayName: 'Docker Push'
